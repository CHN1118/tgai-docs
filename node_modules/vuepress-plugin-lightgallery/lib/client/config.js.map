{"version":3,"file":"config.js","sources":["../../src/client/components/LightGallery.ts","../../src/client/config.ts"],"sourcesContent":["import type { GalleryItem } from \"lightgallery/lg-utils.js\";\nimport lightGallery from \"lightgallery/lightgallery.es5.js\";\nimport type { LightGallery } from \"lightgallery/lightgallery.js\";\nimport type { VNode } from \"vue\";\nimport {\n  defineComponent,\n  h,\n  nextTick,\n  onMounted,\n  onUnmounted,\n  shallowRef,\n  watch,\n} from \"vue\";\nimport { usePageData } from \"vuepress/client\";\n\nimport { useLightGalleryPlugins } from \"@temp/lightgallery/plugins.js\";\n\nimport { useLightGalleryOptions } from \"../helpers/index.js\";\n\nimport \"lightgallery/scss/lightgallery.scss\";\n\ndeclare const __LG_SELECTOR__: string;\ndeclare const __LG_DELAY__: number;\n\nconst getImages = (images: HTMLImageElement[]): GalleryItem[] =>\n  images.map(\n    ({ alt, srcset, src }) =>\n      ({\n        src,\n        srcset,\n        thumb: src || srcset,\n        alt,\n        subHtml: alt,\n      }) as GalleryItem,\n  );\n\nexport default defineComponent({\n  name: \"LightGallery\",\n\n  setup() {\n    const lightGalleryOptions = useLightGalleryOptions();\n    const page = usePageData();\n\n    const container = shallowRef<HTMLElement>();\n\n    let instance: LightGallery | null = null;\n    let id: number;\n\n    const initLightGallery = async (): Promise<void> => {\n      const timeID = (id = new Date().getTime());\n\n      const [lightGalleryPlugins] = await Promise.all([\n        useLightGalleryPlugins(),\n        nextTick().then(\n          () =>\n            new Promise<void>((resolve) => setTimeout(resolve, __LG_DELAY__)),\n        ),\n      ]);\n\n      if (timeID === id) {\n        instance?.destroy();\n\n        const images = Array.from(\n          document.querySelectorAll<HTMLImageElement>(__LG_SELECTOR__),\n        );\n\n        instance = new lightGallery(container.value!, {\n          ...lightGalleryOptions,\n          dynamic: true,\n          dynamicEl: getImages(images),\n          // This is a licenseKey to make this project under MIT, special thanks to @Sachin\n          licenseKey: \"VSY7R-J@WED-CJY76-UMDXQ\",\n          plugins: lightGalleryPlugins.map(({ default: plugin }) => plugin),\n        });\n\n        images.forEach((image, index) => {\n          image.addEventListener(\"click\", () => {\n            instance?.openGallery(index);\n          });\n        });\n      }\n    };\n\n    onMounted(() => {\n      watch(() => page.value.path, initLightGallery, { immediate: true });\n    });\n\n    onUnmounted(() => instance?.destroy());\n\n    return (): VNode =>\n      h(\"div\", { ref: container, class: \"lightgallery-vuepress\" });\n  },\n});\n","import { defineClientConfig } from \"vuepress/client\";\n\nimport LightGallery from \"./components/LightGallery.js\";\nimport { injectLightGalleryConfig } from \"./helpers/index.js\";\n\n// eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\nexport default defineClientConfig({\n  enhance: ({ app }) => {\n    injectLightGalleryConfig(app);\n  },\n  rootComponents: [LightGallery],\n});\n"],"names":["getImages","images","alt","srcset","src","defineComponent","lightGalleryOptions","useLightGalleryOptions","page","usePageData","container","shallowRef","instance","id","initLightGallery","timeID","lightGalleryPlugins","useLightGalleryPlugins","nextTick","resolve","lightGallery","plugin","image","index","onMounted","watch","onUnmounted","h","defineClientConfig","app","injectLightGalleryConfig","LightGallery"],"mappings":"8YAwBA,MAAMA,EAAaC,GACjBA,EAAO,IACL,CAAC,CAAE,IAAAC,EAAK,OAAAC,EAAQ,IAAAC,CAAI,KACjB,CACC,IAAAA,EACA,OAAAD,EACA,MAAOC,GAAOD,EACd,IAAAD,EACA,QAASA,CACX,EACJ,EAEF,MAAeG,EAAgB,CAC7B,KAAM,eAEN,OAAQ,CACN,MAAMC,EAAsBC,EAAuB,EAC7CC,EAAOC,IAEPC,EAAYC,EAAAA,EAElB,IAAIC,EAAgC,KAChCC,EAEJ,MAAMC,EAAmB,SAA2B,CAClD,MAAMC,EAAUF,EAAK,IAAI,OAAO,QAE1B,EAAA,CAACG,CAAmB,EAAI,MAAM,QAAQ,IAAI,CAC9CC,EAAAA,EACAC,IAAW,KACT,IACE,IAAI,QAAeC,GAAY,WAAWA,EAAS,YAAY,CAAC,CACpE,CACF,CAAC,EAED,GAAIJ,IAAWF,EAAI,CACjBD,GAAU,QAAQ,EAElB,MAAMX,EAAS,MAAM,KACnB,SAAS,iBAAmC,eAAe,CAC7D,EAEAW,EAAW,IAAIQ,EAAaV,EAAU,MAAQ,CAC5C,GAAGJ,EACH,QAAS,GACT,UAAWN,EAAUC,CAAM,EAE3B,WAAY,0BACZ,QAASe,EAAoB,IAAI,CAAC,CAAE,QAASK,CAAO,IAAMA,CAAM,CAClE,CAAC,EAEDpB,EAAO,QAAQ,CAACqB,EAAOC,IAAU,CAC/BD,EAAM,iBAAiB,QAAS,IAAM,CACpCV,GAAU,YAAYW,CAAK,CAC7B,CAAC,CACH,CAAC,CACH,CACF,EAEA,OAAAC,EAAU,IAAM,CACdC,EAAM,IAAMjB,EAAK,MAAM,KAAMM,EAAkB,CAAE,UAAW,EAAK,CAAC,CACpE,CAAC,EAEDY,EAAY,IAAMd,GAAU,SAAS,EAE9B,IACLe,EAAE,MAAO,CAAE,IAAKjB,EAAW,MAAO,uBAAwB,CAAC,CAC/D,CACF,CAAC,ECtFckB,EAAAA,EAAmB,CAChC,QAAS,CAAC,CAAE,IAAAC,CAAI,IAAM,CACpBC,EAAyBD,CAAG,CAC9B,EACA,eAAgB,CAACE,CAAY,CAC/B,CAAC"}